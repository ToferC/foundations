{{ define "title"}}

{{ $user := .User }}

<title>View {{ $user.UserName }}</title>

{{ end }}

{{define "content"}}

{{ $user := .User }}
{{ $experiences := .Experiences}}
{{ $targets := $user.LearnerProfile.LearningTargets}}
{{ $currentYear := $user.LearnerProfile.CurrentYear }}
{{ $categorymap := .CategoryMap}}
{{ $progress := percent (index $categorymap "currentTotal") (index $categorymap "targetTotal") }}


    <h3>{{ $user.UserName }}</h3>
    {{ $user.Email}} 
    <hr>

    <h4>Overall Learning Progress for {{ $currentYear }}</h4>
    <div class="progress" style="height: 20px;">
        <div class="progress-bar" role="progressbar" aria-valuenow="{{ index $categorymap "currentTotal" }}" aria-valuemin="0" aria-valuemax="{{ index $categorymap "targetTotal" }}" style="width:{{ $progress }}%">{{ index $categorymap "currentTotal" }} / {{ index $categorymap "targetTotal" }}</div>
    </div>
    <hr>

    <div class="container">
    <h4>Categories</h4>
    <hr>
    {{ range $k, $v := $user.Streams }}
        <h5><strong>{{ $v.Name }}</strong> - Skill: {{ $v.Expertise }}</h5>
        <div class="progress" style="height: 20px;">
            <div class="progress-bar" role="progressbar" aria-valuenow="{{ index $v.LearningTargets $currentYear 1 }}" aria-valuemin="0" aria-valuemax='{{ index $v.LearningTargets $currentYear 0 }}' style='width:{{percent (index $v.LearningTargets $currentYear 1) (index $v.LearningTargets $currentYear 0) }}%'>{{ index $v.LearningTargets $currentYear 1 }} / {{ index $v.LearningTargets $currentYear 0 }}</div>
        </div>
        <p><strong>Interests</strong>: {{ range $pk, $pv := $v.Practices }}
                {{ $pv.Name }} | 
            {{ end }}</p>
            <hr>
    {{ end }}
        </div>

    <hr>

    <h3>Experiences</h3>
    <div class="row">
    {{ range $e := $experiences }}
        {{ if $e.LearningResource }}
    <div class="col-md-4">
        <div class="card mb-4 box-shadow">
    <div class="card-body"></a>
        <h5 class="card-title">{{ $e.LearningResource.Title }}</h5>
        <h6 class="card-subtitle mb-2 text-muted">{{ $e.Stream.Name }}</h6>
        <hr>
        <h6 class="card-subtitle mb-2 text-muted">{{ range $p := $e.Practices }}{{ $p.Name }} | {{ end }}</h6>
        <hr>
        <p class="card-text">
            {{ $e.Comments }}
            <br>
            Value: {{ $e.Value }}<br> 
            Time: {{ $e.Time }}<br>
            Difficulty: {{ $e.Difficulty }}<br>
            Tags: {{ range $tag := $e.Tags }}{{ $tag }} | {{ end }}</p>
        </p>
        <div class="d-flex justify-content-between align-items-center">
          <div class="btn-group">
            <a class="btn btn-sm btn-primary"
            href="{{ $e.LearningResource.Path }}">View</a>
                <a class="btn btn-sm btn-danger" href="/delete_experience/{{ $e.ID }}">Delete</a>
          </div>
        </div>
      </div>
      </div>
    </div>
    {{ end }} <!-- End If -->
    {{ end }}
      </div>

        <hr>

    <h3>Learning Library</h3>
    <p>Will sort by category</p>
    {{ range $lr := .LearningResources }}
        <p><strong>{{ $lr }}</strong> | <a href="{{ $lr.Path}}">Link</a><br>
        <hr>
    {{ end }}
{{ end }}